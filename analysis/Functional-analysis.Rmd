---
title: "Functional Analysis"
author: "John Sterrett"
date: "2023-01-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

pacman::p_load(tidyverse,
               data.table,
               ggplot2,
               phyloseq,
               patchwork,
               microshades,
               cowplot)

```

# Load data
```{r}
source("HUMAnN_to_phyloseq_helper.R")
gn <- fread("../hiv.t32.concat.humann/all_genefamilies_grouped_named.tsv")
rownames(gn) <- gn$`# Gene Family`

genefams <- filter_only_genes(gn)
rownames(genefams) <- genefams$`# Gene Family`
genefams$`# Gene Family` <- NULL

genes <- rownames(genefams)
hier.tab <- make_pseq_tax_table_from_genefams(genes)

ecs.pseq <- phyloseq(otu_table=otu_table(genefams, taxa_are_rows=T), 
                     tax_table=tax_table(hier.tab))


genefams.withtax <- filter_only_genes(gn, with_taxa=T)
```

